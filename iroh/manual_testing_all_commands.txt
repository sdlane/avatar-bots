================================================================================
IROH BOT - COMPLETE MANUAL TESTING GUIDE
================================================================================

This guide covers manual testing for ALL Discord commands in the Iroh bot.
Commands are organized by category and include dependencies, expected results,
and error case testing.

--------------------------------------------------------------------------------
PREREQUISITES
--------------------------------------------------------------------------------

Before testing, ensure you have:
1. A Discord server with the Iroh bot added
2. Admin permissions (manage_guild) on that server
3. At least one character created (via Hawky bot)
4. A second character for multi-character tests (optional but recommended)
5. The database migration has been run (init_db.py)

Note: [Admin] commands require manage_guild permission.
Note: Player commands may require a character linked to your Discord account.

================================================================================
SECTION 1: INITIAL SETUP COMMANDS
================================================================================

These commands help set up the testing environment.

--------------------------------------------------------------------------------
TEST 1.1: /advice
--------------------------------------------------------------------------------
PURPOSE: Fun command that returns Uncle Iroh wisdom

STEPS:
1.1.1 Run the command:
    /advice

    EXPECTED: A random piece of wisdom from Uncle Iroh

1.1.2 Run multiple times:
    /advice
    /advice
    /advice

    EXPECTED: Different quotes each time (may occasionally repeat)


--------------------------------------------------------------------------------
TEST 1.2: /create-test-config
--------------------------------------------------------------------------------
PURPOSE: Create a preconfigured test environment

STEPS:
1.2.1 Clear any existing data first:
    /clear-wargame-config

    EXPECTED: Success message about clearing data

1.2.2 Create test configuration:
    /create-test-config

    EXPECTED: Success message listing created entities (factions, territories, units, etc.)


--------------------------------------------------------------------------------
TEST 1.3: /clear-wargame-config
--------------------------------------------------------------------------------
PURPOSE: Clear all wargame data

STEPS:
1.3.1 After creating test config, clear it:
    /clear-wargame-config

    EXPECTED: Success message about clearing data

1.3.2 Try listing data after clear:
    /list-factions

    EXPECTED: Message indicating no factions exist


================================================================================
SECTION 2: TERRITORY MANAGEMENT (Admin)
================================================================================

--------------------------------------------------------------------------------
TEST 2.1: /create-territory
--------------------------------------------------------------------------------
PURPOSE: Create new territories

STEPS:
2.1.1 Create a basic territory:
    /create-territory territory_id:1 terrain_type:plains name:Central Plains

    EXPECTED: Success message

2.1.2 Create additional territories for adjacency testing:
    /create-territory territory_id:2 terrain_type:mountain name:Northern Mountains
    /create-territory territory_id:3 terrain_type:desert name:Eastern Desert
    /create-territory territory_id:4 terrain_type:ocean name:Western Sea
    /create-territory territory_id:5 terrain_type:lake name:Sacred Lake

    EXPECTED: Success messages for each

2.1.3 Try creating territory with duplicate ID:
    /create-territory territory_id:1 terrain_type:plains name:Duplicate

    EXPECTED: Error about territory already existing

2.1.4 Try invalid terrain type:
    /create-territory territory_id:99 terrain_type:invalid name:Test

    EXPECTED: Error about invalid terrain type


--------------------------------------------------------------------------------
TEST 2.2: /view-territory
--------------------------------------------------------------------------------
PURPOSE: View territory details (Player accessible)

STEPS:
2.2.1 View existing territory:
    /view-territory territory_id:1

    EXPECTED: Embed showing territory details including:
    - Territory ID
    - Name
    - Terrain type
    - Controller (should be uncontrolled initially)
    - Production values
    - Adjacent territories

2.2.2 View nonexistent territory:
    /view-territory territory_id:999

    EXPECTED: Error about territory not found


--------------------------------------------------------------------------------
TEST 2.3: /add-adjacency
--------------------------------------------------------------------------------
PURPOSE: Connect territories

STEPS:
2.3.1 Add adjacency between territories:
    /add-adjacency territory_id_1:1 territory_id_2:2
    /add-adjacency territory_id_1:1 territory_id_2:3
    /add-adjacency territory_id_1:2 territory_id_2:3

    EXPECTED: Success messages

2.3.2 Verify adjacencies:
    /view-territory territory_id:1

    EXPECTED: Should show territories 2 and 3 as adjacent

2.3.3 Try adding duplicate adjacency:
    /add-adjacency territory_id_1:1 territory_id_2:2
    /add-adjacency territory_id_1:2 territory_id_2:1
    EXPECTED: Error message in both cases stating the territories are already adjacent

2.3.4 Try adding adjacency with nonexistent territory:
    /add-adjacency territory_id_1:1 territory_id_2:999

    EXPECTED: Error about territory not found


--------------------------------------------------------------------------------
TEST 2.4: /remove-adjacency
--------------------------------------------------------------------------------
PURPOSE: Remove territory connections

STEPS:
2.4.1 Remove an existing adjacency:
    /remove-adjacency territory_id_1:2 territory_id_2:3

    EXPECTED: Success message

2.4.2 Verify removal:
    /view-territory territory_id:2

    EXPECTED: Territory 3 should no longer be listed as adjacent

2.4.3 Try removing nonexistent territory adjacency:
    /remove-adjacency territory_id_1:1 territory_id_2:999

    EXPECTED: Error message

2.4.4 Try removing nonexistent adjacency:
    /remove-adjacency territory_id_1:2 territory_id_2:3

    EXPECTED: Error message



--------------------------------------------------------------------------------
TEST 2.5: /edit-territory
--------------------------------------------------------------------------------
PURPOSE: Edit territory properties via modal

STEPS:
2.5.1 Open edit modal:
    /edit-territory territory_id:1

    EXPECTED: Modal appears with fields pre-populated with current territory values:
    - Name field shows current name (or empty if none)
    - Original Nation field shows current value (or empty if none)
    - Production field shows 6 comma-separated values: ore,lumber,coal,rations,cloth,platinum

2.5.2 Verify existing values are preserved:
    - Note the current production values displayed in the modal
    - Click Cancel or close without submitting
    - Run /view-territory territory_id:1 to confirm values are unchanged

    EXPECTED: Territory values should be unchanged (modal opening doesn't modify data)

2.5.3 Edit values in the modal:
    - Change name to "Central Plains - Capital"
    - Set production to "10,5,0,0,0,0" (ore=10, lumber=5, others=0)
    - Submit

    EXPECTED: Success message with updated values

2.5.4 Verify changes:
    /view-territory territory_id:1

    EXPECTED: Should show updated name and production values

2.5.5 Test platinum production:
    /edit-territory territory_id:1
    - Set production to "10,5,0,0,0,3" (adding platinum=3)
    - Submit

    EXPECTED: Success message; /view-territory should show platinum_production=3


--------------------------------------------------------------------------------
TEST 2.6: /list-territories
--------------------------------------------------------------------------------
PURPOSE: List all territories

STEPS:
2.6.1 List all territories:
    /list-territories

    EXPECTED: Embed showing all territories with:
    - Territory ID
    - Name
    - Terrain type
    - Controller


--------------------------------------------------------------------------------
TEST 2.7: /delete-territory
--------------------------------------------------------------------------------
PURPOSE: Delete a territory

STEPS:
2.7.1 Delete a territory:
    /delete-territory territory_id:5

    EXPECTED: Success message

2.7.2 Verify deletion:
    /view-territory territory_id:5

    EXPECTED: Error about territory not found

2.7.3 Try deleting nonexistent territory:
    /delete-territory territory_id:999

    EXPECTED: Error message

--------------------------------------------------------------------------------
TEST 2.8: /set-territory-controller (Admin)
--------------------------------------------------------------------------------
PURPOSE: Assign territory control to character or faction

STEPS:
2.8.1 Assign to character:
    /set-territory-controller territory_id:1 character:test-leader

    EXPECTED: Success message

2.8.2 Verify:
    /view-territory territory_id:1

    EXPECTED: Controller should show test-leader

2.8.3 Assign to faction:
    /set-territory-controller territory_id:1 faction:fire-nation

    EXPECTED: Success message

2.8.4 Remove controller:
    /set-territory-controller territory_id:1 character:none

    EXPECTED: Success message

2.8.5 Try both character and faction:
    /set-territory-controller territory_id:1 character:test-leader faction:fire-nation

    EXPECTED: Error about mutual exclusivity

2.8.6 Leave with test-leader owning territory for later tests
   /set-territory-controller territory_id:1 character:test-leader


================================================================================
SECTION 3: FACTION MANAGEMENT (Admin)
================================================================================

--------------------------------------------------------------------------------
TEST 3.1: /create-faction
--------------------------------------------------------------------------------
PURPOSE: Create new factions

PREREQUISITE: Have a character created via Hawky (e.g., "test-leader")

STEPS:
3.1.1 Create a faction with leader and nation:
    /create-faction faction_id:fire-nation name:Fire Nation leader:test-leader nation:fire-nation

    EXPECTED: Success message

3.1.2 Create a faction without nation:
    /create-faction faction_id:earth-kingdom name:Earth Kingdom

    EXPECTED: Success message (nation will be null)

3.1.3 Try creating duplicate faction:
    /create-faction faction_id:fire-nation name:Duplicate

    EXPECTED: Error about faction already existing

3.1.4 Try creating faction with invalid leader:
    /create-faction faction_id:test-faction name:Test leader:nonexistent-char

    EXPECTED: Error about character not found

3.1.5 Verify nation in view:
    /view-faction faction_id:fire-nation

    EXPECTED: Should show nation: fire-nation


--------------------------------------------------------------------------------
TEST 3.2: /view-faction
--------------------------------------------------------------------------------
PURPOSE: View faction details

STEPS:
3.2.1 View as admin:
    /view-faction faction_id:fire-nation

    EXPECTED: Full embed with:
    - Faction name and ID
    - Leader name
    - Member list

3.2.2 View nonexistent faction:
    /view-faction faction_id:nonexistent

    EXPECTED: Error about faction not found

Note: Non-admin users see limited information


--------------------------------------------------------------------------------
TEST 3.3: /list-factions
--------------------------------------------------------------------------------
PURPOSE: List all factions

STEPS:
3.3.1 List factions:
    /list-factions

    EXPECTED: Embed showing all factions with:
    - Faction ID
    - Name
    - Member count


--------------------------------------------------------------------------------
TEST 3.4: /add-faction-member
--------------------------------------------------------------------------------
PURPOSE: Add members to a faction

PREREQUISITE: Create another character via Hawky (e.g., "test-member")

STEPS:
3.4.1 Add a member:
    /add-faction-member faction_id:fire-nation character:test-member

    EXPECTED: Success message

3.4.2 Verify:
    /view-faction faction_id:fire-nation

    EXPECTED: test-member should appear in member list

3.4.3 Try adding to nonexistent faction:
    /add-faction-member faction_id:nonexistent character:test-member

    EXPECTED: Error about faction not found

3.4.4 Try adding nonexistent character:
    /add-faction-member faction_id:fire-nation character:nonexistent

    EXPECTED: Error about character not found

3.4.5 Try adding character already in the SAME faction:
    /add-faction-member faction_id:fire-nation character:test-member

    EXPECTED: Error about character already a member of that faction

3.4.6 Multi-faction: Add character to a second faction:
    /add-faction-member faction_id:earth-kingdom character:test-member

    EXPECTED: Success - characters can now be members of multiple factions


--------------------------------------------------------------------------------
TEST 3.5: /set-faction-leader
--------------------------------------------------------------------------------
PURPOSE: Change faction leadership

STEPS:
3.5.1 Change leader:
    /set-faction-leader faction_id:fire-nation leader:test-member

    EXPECTED: Success message

3.5.2 Verify change:
    /view-faction faction_id:fire-nation

    EXPECTED: test-member should now be leader

3.5.3 Remove leader:
    /set-faction-leader faction_id:fire-nation leader:none

    EXPECTED: Success message

3.5.4 Try setting nonexistent character as leader:
    /set-faction-leader faction_id:fire-nation leader:nonexistent

    EXPECTED: Error about character not found


--------------------------------------------------------------------------------
TEST 3.6: /remove-faction-member
--------------------------------------------------------------------------------
PURPOSE: Remove members from a faction

NOTE: Characters can now be members of multiple factions. The faction_id parameter
specifies which faction to remove from. If not specified, removes from represented faction.

STEPS:
3.6.1 Remove a member from a specific faction:
    /remove-faction-member character:test-member faction_id:fire-nation

    EXPECTED: Success message

3.6.2 Verify:
    /view-faction faction_id:fire-nation

    EXPECTED: test-member should not appear in member list

3.6.3 Try removing nonexistent character:
    /remove-faction-member character:nonexistent faction_id:fire-nation

    EXPECTED: Error message

3.6.4 Try removing from faction character is not in:
    /remove-faction-member character:test-member faction_id:fire-nation

    EXPECTED: Error message (not a member of that faction)

3.6.5 Try removing the faction leader:
    /set-faction-leader faction_id:fire-nation leader:test-leader
    /remove-faction-member character:test-leader

    EXPECTED: Error message


--------------------------------------------------------------------------------
TEST 3.7: /delete-faction
--------------------------------------------------------------------------------
PURPOSE: Delete a faction

STEPS:
3.7.1 Delete a faction:
    /delete-faction faction_id:earth-kingdom

    EXPECTED: Success message

3.7.2 Verify:
    /view-faction faction_id:earth-kingdom

    EXPECTED: Error about faction not found


--------------------------------------------------------------------------------
TEST 3.8: /set-faction-nation (Admin)
--------------------------------------------------------------------------------
PURPOSE: Set or update a faction's nation

STEPS:
3.8.1 Set nation for existing faction:
    /set-faction-nation faction_id:fire-nation nation:fire-nation

    EXPECTED: Success message

3.8.2 Verify:
    /view-faction faction_id:fire-nation

    EXPECTED: Should show nation: fire-nation

3.8.3 Update nation:
    /set-faction-nation faction_id:fire-nation nation:fifth-nation

    EXPECTED: Success message showing old and new nation

3.8.4 Try setting nation for nonexistent faction:
    /set-faction-nation faction_id:nonexistent nation:fire-nation

    EXPECTED: Error about faction not found


================================================================================
SECTION 4: UNIT TYPE MANAGEMENT (Admin)
================================================================================

--------------------------------------------------------------------------------
TEST 4.1: /create-unit-type
--------------------------------------------------------------------------------
PURPOSE: Create unit types via modal

STEPS:
4.1.1 Create a nation-agnostic unit type:
    /create-unit-type type_id:infantry name:Infantry

    EXPECTED: Modal appears for entering stats

4.1.2 In the modal:
    - Set movement: 2
    - Set organization: 10
    - Set attack: 5
    - Set defense: 5
    - Set siege values as desired
    - Set upkeep values as desired
    - Submit

    EXPECTED: Success message

4.1.3 Create a nation-specific unit type:
    /create-unit-type type_id:cavalry name:Fire Nation Cavalry

    EXPECTED: Modal appears

4.1.4 Create unit specific unit type. In the modal:
    - Set nation to fire-nation
    - Submit

4.1.5 Try creating duplicate:
    /create-unit-type type_id:infantry name:Duplicate

    EXPECTED: Error about unit type already existing


--------------------------------------------------------------------------------
TEST 4.2: /view-unit-type
--------------------------------------------------------------------------------
PURPOSE: View unit type details

STEPS:
4.2.1 View nation-agnostic type:
    /view-unit-type type_id:infantry

    EXPECTED: Embed showing unit type stats

4.2.2 View nonexistent:
    /view-unit-type type_id:nonexistent

    EXPECTED: Error about unit type not found


--------------------------------------------------------------------------------
TEST 4.3: /list-unit-types
--------------------------------------------------------------------------------
PURPOSE: List all unit types

STEPS:
4.3.1 List unit types:
    /list-unit-types

    EXPECTED: Embed showing all unit types with:
    - Type ID
    - Name
    - Nation (if applicable)


--------------------------------------------------------------------------------
TEST 4.4: /edit-unit-type
--------------------------------------------------------------------------------
PURPOSE: Edit unit type properties

STEPS:
4.4.1 Edit a unit type:
    /edit-unit-type type_id:infantry

    EXPECTED: Modal with current values

4.4.2 Make changes and submit

    EXPECTED: Success message

4.4.3 Verify:
    /view-unit-type type_id:infantry

    EXPECTED: Updated values shown


--------------------------------------------------------------------------------
TEST 4.5: /delete-unit-type
--------------------------------------------------------------------------------
PURPOSE: Delete a unit type

STEPS:
4.5.1 Delete:
    /delete-unit-type type_id:cavalry

    EXPECTED: Success message

4.5.2 Verify:
    /view-unit-type type_id:cavalry

    EXPECTED: Error about unit type not found


================================================================================
SECTION 4A: BUILDING TYPE MANAGEMENT (Admin)
================================================================================

--------------------------------------------------------------------------------
TEST 4A.1: /create-building-type
--------------------------------------------------------------------------------
PURPOSE: Create building types via modal

STEPS:
4A.1.1 Create a basic building type:
    /create-building-type type_id:barracks name:Military Barracks

    EXPECTED: Modal appears for entering description and costs

4A.1.2 In the modal:
    - Set description: "A training facility for soldiers"
    - Set cost: 10,10,0,5,0,0 (ore=10, lumber=10, rations=5)
    - Set upkeep: 0,1,0,2,0,0 (lumber=1, rations=2)
    - Submit

    EXPECTED: Success message

4A.1.3 Create another building type:
    /create-building-type type_id:workshop name:Craftsman Workshop

    EXPECTED: Modal appears

4A.1.4 Try creating duplicate:
    /create-building-type type_id:barracks name:Duplicate

    EXPECTED: Error about building type already existing


--------------------------------------------------------------------------------
TEST 4A.2: /view-building-type
--------------------------------------------------------------------------------
PURPOSE: View building type details (Player accessible)

STEPS:
4A.2.1 View existing building type:
    /view-building-type type_id:barracks

    EXPECTED: Embed showing:
    - Building name and type_id
    - Description
    - Construction cost (with resource emojis)
    - Upkeep per turn (with resource emojis)

4A.2.2 View nonexistent:
    /view-building-type type_id:nonexistent

    EXPECTED: Error about building type not found


--------------------------------------------------------------------------------
TEST 4A.3: /list-building-types
--------------------------------------------------------------------------------
PURPOSE: List all building types

STEPS:
4A.3.1 List building types:
    /list-building-types

    EXPECTED: Embed showing all building types with:
    - Type ID
    - Name
    - Description (truncated if long)


--------------------------------------------------------------------------------
TEST 4A.4: /edit-building-type
--------------------------------------------------------------------------------
PURPOSE: Edit building type properties

STEPS:
4A.4.1 Edit a building type:
    /edit-building-type type_id:barracks

    EXPECTED: Modal with current values pre-populated

4A.4.2 Make changes:
    - Change description to "An upgraded training facility"
    - Change cost to 15,15,0,5,0,0
    - Submit

    EXPECTED: Success message

4A.4.3 Verify:
    /view-building-type type_id:barracks

    EXPECTED: Updated values shown

4A.4.4 Try editing nonexistent:
    /edit-building-type type_id:nonexistent

    EXPECTED: Error about building type not found


--------------------------------------------------------------------------------
TEST 4A.5: /delete-building-type
--------------------------------------------------------------------------------
PURPOSE: Delete a building type

STEPS:
4A.5.1 Delete:
    /delete-building-type type_id:workshop

    EXPECTED: Success message

4A.5.2 Verify:
    /view-building-type type_id:workshop

    EXPECTED: Error about building type not found

4A.5.3 Try deleting nonexistent:
    /delete-building-type type_id:nonexistent

    EXPECTED: Error message


--------------------------------------------------------------------------------
TEST 4A.6: Building Type Validation
--------------------------------------------------------------------------------
PURPOSE: Test input validation in modal

STEPS:
4A.6.1 Create with invalid cost format:
    /create-building-type type_id:test-invalid name:Test Invalid
    - In modal, set cost to "abc,def,ghi,jkl,mno,pqr"
    - Submit

    EXPECTED: Error about invalid cost values

4A.6.2 Create with wrong number of cost values:
    /create-building-type type_id:test-invalid2 name:Test Invalid 2
    - In modal, set cost to "10,10,10"
    - Submit

    EXPECTED: Error about cost must have exactly 6 values

4A.6.3 Create with negative values:
    /create-building-type type_id:test-invalid3 name:Test Invalid 3
    - In modal, set cost to "-5,10,0,0,0,0"
    - Submit

    EXPECTED: Error about cost values cannot be negative

CLEANUP:
    /delete-building-type type_id:barracks


================================================================================
SECTION 4B: BUILDING MANAGEMENT (Admin)
================================================================================

--------------------------------------------------------------------------------
TEST 4B.1: /create-building
--------------------------------------------------------------------------------
PURPOSE: Create buildings in territories

PREREQUISITES:
- At least one building type exists (e.g., barracks)
- At least one territory exists

STEPS:
4B.1.1 Create a building:
    /create-building building_id:fire-barracks building_type:barracks territory_id:1

    EXPECTED: Success message showing building created

4B.1.2 Create with custom name:
    /create-building building_id:earth-workshop building_type:workshop territory_id:2 name:Toph's Workshop

    EXPECTED: Success message

4B.1.3 Try creating duplicate:
    /create-building building_id:fire-barracks building_type:barracks territory_id:1

    EXPECTED: Error about building already existing

4B.1.4 Try creating with invalid building type:
    /create-building building_id:test-building building_type:nonexistent territory_id:1

    EXPECTED: Error about building type not found

4B.1.5 Try creating with invalid territory:
    /create-building building_id:test-building building_type:barracks territory_id:999

    EXPECTED: Error about territory not found


--------------------------------------------------------------------------------
TEST 4B.2: /view-building
--------------------------------------------------------------------------------
PURPOSE: View building details (Player accessible)

STEPS:
4B.2.1 View existing building:
    /view-building building_id:fire-barracks

    EXPECTED: Embed showing:
    - Building name and ID
    - Building type
    - Location (territory name)
    - Durability (10 by default)
    - Status (ACTIVE)
    - Upkeep costs (with resource emojis)

4B.2.2 View nonexistent:
    /view-building building_id:nonexistent

    EXPECTED: Error about building not found


--------------------------------------------------------------------------------
TEST 4B.3: /view-territory (Buildings Integration)
--------------------------------------------------------------------------------
PURPOSE: Verify buildings appear in territory view

STEPS:
4B.3.1 View territory with buildings:
    /view-territory territory_id:1

    EXPECTED: Territory embed includes section listing buildings:
    - fire-barracks (barracks) - Durability: 10


--------------------------------------------------------------------------------
TEST 4B.4: /edit-building
--------------------------------------------------------------------------------
PURPOSE: Edit building properties

STEPS:
4B.4.1 Edit building name:
    /edit-building building_id:fire-barracks name:Royal Barracks

    EXPECTED: Success message

4B.4.2 Edit durability:
    /edit-building building_id:fire-barracks durability:5

    EXPECTED: Success message

4B.4.3 Edit status to DESTROYED:
    /edit-building building_id:fire-barracks status:DESTROYED

    EXPECTED: Success message

4B.4.4 Verify changes:
    /view-building building_id:fire-barracks

    EXPECTED: Updated name, durability, and status shown

4B.4.5 Reset status to ACTIVE:
    /edit-building building_id:fire-barracks status:ACTIVE durability:10

    EXPECTED: Success message

4B.4.6 Try editing nonexistent:
    /edit-building building_id:nonexistent name:Test

    EXPECTED: Error about building not found

4B.4.7 Try editing with invalid status:
    /edit-building building_id:fire-barracks status:INVALID

    EXPECTED: Error about invalid status

4B.4.8 Try editing with negative durability:
    /edit-building building_id:fire-barracks durability:-5

    EXPECTED: Error about negative durability


--------------------------------------------------------------------------------
TEST 4B.5: /delete-building
--------------------------------------------------------------------------------
PURPOSE: Delete a building

STEPS:
4B.5.1 Delete:
    /delete-building building_id:earth-workshop

    EXPECTED: Success message

4B.5.2 Verify:
    /view-building building_id:earth-workshop

    EXPECTED: Error about building not found

4B.5.3 Try deleting nonexistent:
    /delete-building building_id:nonexistent

    EXPECTED: Error message


CLEANUP:
    /delete-building building_id:fire-barracks


================================================================================
SECTION 5: UNIT MANAGEMENT (Admin)
================================================================================

--------------------------------------------------------------------------------
TEST 5.1: /create-unit
--------------------------------------------------------------------------------
PURPOSE: Create units with character or faction ownership

PREREQUISITES:
- At least one unit type exists
- At least one territory exists
- Character or faction exists to own unit

STEPS:
5.1.1 Create character-owned unit:
    /create-unit unit_id:FN-001 unit_type:infantry territory_id:1 owner:test-leader

    EXPECTED: Success message

5.1.2 Create faction-owned unit:
    /create-unit unit_id:FN-002 unit_type:infantry territory_id:1 owner_faction:fire-nation

    EXPECTED: Success message

5.1.3 Try both owner and owner_faction:
    /create-unit unit_id:FAIL-001 unit_type:infantry territory_id:1 owner:test-leader owner_faction:fire-nation

    EXPECTED: Error about mutual exclusivity

5.1.4 Try no owner specified:
    /create-unit unit_id:FAIL-002 unit_type:infantry territory_id:1

    EXPECTED: Error about must specify owner

5.1.5 Try duplicate unit ID:
    /create-unit unit_id:FN-001 unit_type:infantry territory_id:1 owner:test-leader

    EXPECTED: Error about unit already existing


--------------------------------------------------------------------------------
TEST 5.2: /view-unit
--------------------------------------------------------------------------------
PURPOSE: View unit details

STEPS:
5.2.1 View existing unit:
    /view-unit unit_id:FN-001

    EXPECTED: Embed showing:
    - Unit ID and name
    - Type
    - Owner
    - Commander
    - Location
    - Stats (for admin)

5.2.2 View nonexistent:
    /view-unit unit_id:NONEXISTENT

    EXPECTED: Error about unit not found


--------------------------------------------------------------------------------
TEST 5.3: /list-units
--------------------------------------------------------------------------------
PURPOSE: List all units

STEPS:
5.3.1 List units:
    /list-units

    EXPECTED: Embed showing all units with:
    - Unit ID
    - Type/Name
    - Faction
    - Location
    - Owner


--------------------------------------------------------------------------------
TEST 5.4: /set-unit-commander
--------------------------------------------------------------------------------
PURPOSE: Assign commanders to units

STEPS:
5.4.1 Assign commander:
    /set-unit-commander unit_id:FN-001 commander:test-member

    EXPECTED: Success message

5.4.2 Verify:
    /view-unit unit_id:FN-001

    EXPECTED: Commander field shows test-memver

5.4.3 Remove commander:
    /set-unit-commander unit_id:FN-001 commander:none

    EXPECTED: Success message

5.4.4 Try nonexistent unit:
    /set-unit-commander unit_id:NONEXISTENT commander:test-member

    EXPECTED: Error message


--------------------------------------------------------------------------------
TEST 5.5: /set-unit-status
--------------------------------------------------------------------------------
PURPOSE: Change unit active/disbanded status

STEPS:
5.5.1 Disband a unit:
    /set-unit-status unit_id:FN-001 status:DISBANDED

    EXPECTED: Success message

5.5.2 Verify:
    /view-unit unit_id:FN-001

    EXPECTED: Status shows DISBANDED

5.5.3 Reactivate:
    /set-unit-status unit_id:FN-001 status:ACTIVE

    EXPECTED: Success message


--------------------------------------------------------------------------------
TEST 5.6: /delete-unit
--------------------------------------------------------------------------------
PURPOSE: Delete units

STEPS:
5.6.1 Delete:
    /delete-unit unit_id:FN-002

    EXPECTED: Success message

5.6.2 Verify:
    /view-unit unit_id:FN-002

    EXPECTED: Error about unit not found


================================================================================
SECTION 6: RESOURCE MANAGEMENT (Admin)
================================================================================

--------------------------------------------------------------------------------
TEST 6.1: /modify-resources
--------------------------------------------------------------------------------
PURPOSE: Modify character resources via modal

STEPS:
6.1.1 Open modal:
    /modify-resources character:test-leader

    EXPECTED: Modal showing current resource values

6.1.2 Modify values and submit

    EXPECTED: Success message with changes

6.1.3 Try nonexistent character:
    /modify-resources character:nonexistent

    EXPECTED: Error message


--------------------------------------------------------------------------------
TEST 6.2: /modify-character-production
--------------------------------------------------------------------------------
PURPOSE: Modify character's production values

STEPS:
6.2.1 Open modal:
    /modify-character-production character:test-leader

    EXPECTED: Modal showing production values

6.2.2 Modify and submit

    EXPECTED: Success message


--------------------------------------------------------------------------------
TEST 6.3: /modify-character-vp
--------------------------------------------------------------------------------
PURPOSE: Modify character's victory points

STEPS:
6.3.1 Open modal:
    /modify-character-vp character:test-leader

    EXPECTED: Modal for VP modification

6.3.2 Modify and submit

    EXPECTED: Success message


================================================================================
SECTION 7: TURN MANAGEMENT (Admin)
================================================================================

--------------------------------------------------------------------------------
TEST 7.1: /edit-wargame-config
--------------------------------------------------------------------------------
PURPOSE: Edit wargame configuration

STEPS:
7.1.1 Open modal:
    /edit-wargame-config

    EXPECTED: Modal with current config values

7.1.2 Modify and submit

    EXPECTED: Success message


--------------------------------------------------------------------------------
TEST 7.2 /turn-status
--------------------------------------------------------------------------------
PURPOSE: View current turn status

STEPS:
7.2.1 View status:
    /turn-status

    EXPECTED: Embed showing:
    - Current turn number
    - Pending orders summary
    - Other turn state


--------------------------------------------------------------------------------
TEST 7.3: /set-gm-reports-channel
--------------------------------------------------------------------------------
PURPOSE: Set channel for GM reports

STEPS:
7.3.1 Set channel:
    /set-gm-reports-channel channel:#bot-testing

    EXPECTED: Success message


--------------------------------------------------------------------------------
TEST 7.4: /resolve-turn
--------------------------------------------------------------------------------
PURPOSE: Execute turn resolution

STEPS:
7.4.1 Resolve turn:
    /resolve-turn

    EXPECTED:
    - Success message
    - GM report sent to configured channel
    - Character reports sent to their channels

7.4.2 Verify turn number incremented:
    /turn-status

    EXPECTED: Turn number should be +1


--------------------------------------------------------------------------------
TEST 7.5: /turn-report (Player)
--------------------------------------------------------------------------------
PURPOSE: View your character's turn report

STEPS:
7.5.1 View latest:
    /turn-report

    EXPECTED: Embed with events from latest turn

7.5.2 View specific turn:
    /turn-report turn_number:1

    EXPECTED: Embed with events from turn 1


--------------------------------------------------------------------------------
TEST 7.6: /gm-turn-report (Admin)
--------------------------------------------------------------------------------
PURPOSE: View GM turn report

STEPS:
7.6.1 View latest:
    /gm-turn-report

    EXPECTED: Embed with all events from latest turn

7.6.2 View specific turn:
    /gm-turn-report turn_number:1

    EXPECTED: Embed with events from turn 1


================================================================================
SECTION 8: ORDER COMMANDS (Player)
================================================================================

Not transit is not implemented yet so it's "commented out"

#--------------------------------------------------------------------------------
#TEST 8.1: /order-transit
#--------------------------------------------------------------------------------
# PURPOSE: Submit unit movement orders

# PREREQUISITES:
# - Unit with commander (your character)
# - Valid path through adjacent territories

# STEPS:
# 8.1.1 Submit transit order:
#     /order-transit unit_ids:FN-001 path:1,2

#     EXPECTED: Success message about order submitted

# 8.1.2 Verify:
#     /my-orders

#     EXPECTED: Transit order should appear

# 8.1.3 Try invalid path (non-adjacent):
#     /order-transit unit_ids:FN-001 path:1,3,4

#     EXPECTED: Error about path not being valid

# 8.1.4 Try with unit you don't command:
#    EXPECTED: Error about authorization


--------------------------------------------------------------------------------
TEST 8.2: /order-assign-commander
--------------------------------------------------------------------------------
PURPOSE: Assign new commander to your unit

STEPS:
8.2.1 Submit order:
    /order-assign-commander unit_id:FN-001 new_commander:test-member

    EXPECTED: Success message (or confirmation dialog if faction mismatch)

8.2.2 Verify:
    /my-orders

    EXPECTED: Assign commander order should appear


--------------------------------------------------------------------------------
TEST 8.3: /order-resource-transfer
--------------------------------------------------------------------------------
PURPOSE: Submit one-time resource transfer

STEPS:
8.3.1 Submit transfer:
    /order-resource-transfer recipient:test-member ore:10 lumber:5

    EXPECTED: Success message

8.3.2 Try with no resources:
    /order-resource-transfer recipient:test-member

    EXPECTED: Error about must transfer at least one resource


--------------------------------------------------------------------------------
TEST 8.4: /order-ongoing-transfer
--------------------------------------------------------------------------------
PURPOSE: Submit recurring resource transfer

STEPS:
8.4.1 Submit with term:
    /order-ongoing-transfer recipient:test-member ore:5 term:5

    EXPECTED: Success message

8.4.2 Submit indefinite:
    /order-ongoing-transfer recipient:test-member lumber:3

    EXPECTED: Success message

8.4.3 Try term < 2:
    /order-ongoing-transfer recipient:test-member ore:5 term:1

    EXPECTED: Error about term must be at least 2


--------------------------------------------------------------------------------
TEST 8.5: /order-cancel-transfer
--------------------------------------------------------------------------------
PURPOSE: Cancel ongoing transfers

STEPS:
8.5.1 Get order ID from /my-orders
8.5.2 Cancel transfer:
    /order-cancel-transfer order_id:ORD-XXXX

    EXPECTED: Success message


--------------------------------------------------------------------------------
TEST 8.6: /cancel-order
--------------------------------------------------------------------------------
PURPOSE: Cancel pending orders

STEPS:
8.6.1 Get order ID from /my-orders
8.6.2 Cancel:
    /cancel-order order_id:ORD-XXXX

    EXPECTED: Success message

7.6.3 Try cancelling ongoing order:
    EXPECTED: Error (use /order-cancel-transfer for ongoing transfers)


--------------------------------------------------------------------------------
TEST 8.7: /order-join-faction
--------------------------------------------------------------------------------
PURPOSE: Request to join a faction

SETUP - Switch your character to test-member

STEPS:
8.7.1 Submit join request:
    /order-join-faction faction_id:fire-nation

    EXPECTED: Success message about order submitted

8.7.2 Switch your character to test-leader
    EXPECTED: Confirmation message

8.7.3 Confirm the joining
    /order-join-faction faction_id:fire-nation character_identifier:test-member
    EXPECTED: Success message about order submitted

8.7.4 Resolve the turn
    /resolve-turn

--------------------------------------------------------------------------------
TEST 8.8: /order-kick-from-faction
--------------------------------------------------------------------------------
PURPOSE: Kick a member from faction (faction leader only)

PREREQUISITE: You are faction leader

STEPS:
8.8.1 Submit kick order:
    /order-kick-from-faction target_character:test-member

    EXPECTED: Error message about it being too early

8.8.2 Resolve a few turns:
    /resolve-turn
    /resolve-turn

8.8.3 Try again:
    /order-kick-from-faction target_character:test-member

    EXPECTED: Success

8.8.4 Rseolve turn again
   /resolve-turn

   EXPECTED: Note in the GM turn report that test-member was kicked from faction


--------------------------------------------------------------------------------
TEST 8.9: /order-leave-faction
--------------------------------------------------------------------------------
PURPOSE: Leave a faction

NOTE: Characters can now be members of multiple factions. The faction_id parameter
is optional - if not specified, leaves the represented faction.

Setup:
- Switch your character to test-member
- /add-faction-member faction_id:fire-nation character:test-member

STEPS:
8.9.1 Submit leave order (default - leaves represented faction):
    /order-leave-faction

    EXPECTED: Success message

8.9.2 Submit leave order for specific faction:
    /order-leave-faction faction_id:fire-nation

    EXPECTED: Success message

8.9.3 Resolve turn:
    /resolve-turn

    EXPECTED: Note in the turn report about test-member leaving the faction

Cleanup - Switch your character to test-leader


--------------------------------------------------------------------------------
TEST 8.10: /order-assign-vp
--------------------------------------------------------------------------------
PURPOSE: Assign your VPs to a faction

STEPS:
8.10.1 Submit assignment:
    /order-assign-vp faction_id:fire-nation

    EXPECTED: Success message


--------------------------------------------------------------------------------
TEST 8.11: /order-make-alliance
--------------------------------------------------------------------------------
PURPOSE: Propose alliance (faction leader only)

SETUP: /create-faction faction_id:earth-kingdom name:Earth Kingdom
       /add-faction-member faction_id:earth-kingdom character:test-member
     

STEPS:
8.11.1 Submit alliance order:
    /order-make-alliance target_faction_id:earth-kingdom

    EXPECTED: Success message

8.11.2 Resolve turn
   /resolve-turn

   EXPECTED: Note in the Beginning phase of the turn log that there is a pending alliance

8.11.3 Switch to test-member, then submit another alliance order
   /order-make-alliance target_faction_id:fire-nation

   EXPECTED: Error that only the faction leader can propose alliances

8.11.4 Make test-member the leader of the earth kingdom, then submit another alliance order
   /set-faction-leader faction_id:earth-kingdom leader:test-member
   /order-make-alliance target_faction_id:fire-nation

   EXPECTED: Success message

8.11.5 Resolve Turn
   /resolve-turn

   EXPECTED: Message in the logs that the alliance has been processed

CLEANUP
   /set-faction-leader faction_id:earth-kingdom leader:none
   /remove-faction-member character:test-member

   Set character to test-leader
   


--------------------------------------------------------------------------------
TEST 8.12: /order-declare-war
--------------------------------------------------------------------------------
PURPOSE: Declare war (faction leader only)

STEPS:
8.12.1 Submit declaration:
    /order-declare-war target_faction_ids:earth-kingdom objective:Conquest of the Earth Kingdom

    EXPECTED: Success message


--------------------------------------------------------------------------------
TEST 8.13: /order-mobilize
--------------------------------------------------------------------------------
PURPOSE: Submit unit mobilization orders

PREREQUISITES (from test_config.yaml - load with /import-config):
- Factions: test-fn (Fire Nation), test-ek (Earth Kingdom), test-wt (Water Tribe)
- Territories: 1 (fire-nation), 2 (earth-kingdom), 3 (water-tribe)
- Unit types: infantry (fire-nation), cavalry (earth-kingdom), waterbenders (water-tribe)
- Characters: test-zuko (leader of test-fn), test-toph (leader of test-ek)

SETUP:
- Assign your Discord user to test-zuko (faction leader of test-fn)
- Give test-zuko resources: /modify-resources character:test-zuko
  (Set ore:50, lumber:50, rations:50, cloth:50 to cover costs)

STEPS:
8.13.1 Personal mobilization (as test-zuko in fire-nation territory):
    /order-mobilize unit_type:infantry territory_id:1

    EXPECTED: Success message with order ID

8.13.2 Faction mobilization (grant CONSTRUCTION permission first):
    /grant-faction-permission faction_id:test-fn character:test-zuko permission_type:CONSTRUCTION
    /order-mobilize unit_type:infantry territory_id:1 faction_id:test-fn

    EXPECTED: Success message referencing Fire Nation resources

8.13.3 Verify order:
    /my-orders

    EXPECTED: MOBILIZATION order listed

8.13.4 Resolve turn:
    /resolve-turn

    EXPECTED: UNIT_MOBILIZED event in turn report

8.13.5 Verify unit created:
    /list-units

    EXPECTED: New unit appears with FN-XXX unit ID in territory 1

ERROR CASES:
8.13.6 Wrong nation unit type (cavalry is earth-kingdom, not fire-nation):
    /order-mobilize unit_type:cavalry territory_id:1

    EXPECTED: Error about nation mismatch

8.13.7 Wrong territory nation (territory 2 is earth-kingdom):
    /order-mobilize unit_type:infantry territory_id:2

    EXPECTED: Error about territory original_nation mismatch

8.13.8 Territory not controlled by faction:
    /order-mobilize unit_type:infantry territory_id:2 faction_id:test-fn

    EXPECTED: Error about territory not controlled by Fire Nation

8.13.9 Missing CONSTRUCTION permission (switch to test-azula first):
    - Assign to test-azula (member but not leader)
    /order-mobilize unit_type:infantry territory_id:1 faction_id:test-fn

    EXPECTED: Error about missing CONSTRUCTION permission


--------------------------------------------------------------------------------
TEST 8.14: /order-construct
--------------------------------------------------------------------------------
PURPOSE: Submit building construction orders

PREREQUISITES (from test_config.yaml):
- Building types: barracks, workshop, warehouse
- Territories: 1, 2, 3
- Faction: test-fn with test-zuko as leader

SETUP:
- Assign your Discord user to test-zuko
- Give test-zuko resources: /modify-resources character:test-zuko
  (Set ore:50, lumber:50, rations:50 to cover costs)

STEPS:
8.14.1 Personal construction:
    /order-construct building_type:barracks territory_id:1

    EXPECTED: Success message with order ID

8.14.2 Faction construction (with CONSTRUCTION permission):
    /grant-faction-permission faction_id:test-fn character:test-zuko permission_type:CONSTRUCTION
    /order-construct building_type:workshop territory_id:1 faction_id:test-fn

    EXPECTED: Success message referencing Fire Nation resources

8.14.3 Verify order:
    /my-orders

    EXPECTED: CONSTRUCTION order listed

8.14.4 Resolve turn:
    /resolve-turn

    EXPECTED: BUILDING_CONSTRUCTED event in turn report

8.14.5 Verify building:
    /view-territory territory_id:1

    EXPECTED: New building listed (BLD-XXXX)

ERROR CASES:
8.14.6 Building type not found:
    /order-construct building_type:nonexistent territory_id:1

    EXPECTED: Error about building type not found

8.14.7 Missing CONSTRUCTION permission (switch to test-azula):
    - Assign to test-azula
    /order-construct building_type:barracks territory_id:1 faction_id:test-fn

    EXPECTED: Error about missing CONSTRUCTION permission


================================================================================
SECTION 8A: UNIT ORDERS (/order-unit)
================================================================================

The /order-unit command replaces the old /order-move-units (transit-only) with
support for all 10 action types: 6 land actions and 4 naval actions.

--------------------------------------------------------------------------------
TEST 8A.1: Basic Transit Order (Single Unit)
--------------------------------------------------------------------------------
PURPOSE: Test basic transit order submission

PREREQUISITES:
- Unit you command in territory 1
- Path through adjacent territories (1 -> 2)

STEPS:
8A.1.1 Submit transit order:
    /order-unit unit_ids:FN-001 action:Transit (land) path:1,2

    EXPECTED: Success message with order ID

8A.1.2 Verify order:
    /my-orders

    EXPECTED: UNIT order with action=transit listed


--------------------------------------------------------------------------------
TEST 8A.2: Unit Groups (Multiple Units)
--------------------------------------------------------------------------------
PURPOSE: Test ordering multiple units together

PREREQUISITES:
- Multiple units in same territory (FN-001, FN-002 in territory 1)

STEPS:
8A.2.1 Submit order for multiple units:
    /order-unit unit_ids:FN-001,FN-002 action:Transit (land) path:1,2

    EXPECTED: Success message listing both units

8A.2.2 Verify:
    /my-orders

    EXPECTED: Single order with both units


--------------------------------------------------------------------------------
TEST 8A.3: Patrol with Speed Parameter
--------------------------------------------------------------------------------
PURPOSE: Test patrol orders with speed setting

STEPS:
8A.3.1 Submit patrol with speed:
    /order-unit unit_ids:FN-001 action:Patrol (land) path:1,2,3 speed:2

    EXPECTED: Success message with speed noted

8A.3.2 Try speed with non-patrol action:
    /order-unit unit_ids:FN-001 action:Transit (land) path:1,2 speed:2

    EXPECTED: Error about speed only valid for patrol actions

8A.3.3 Try patrol with single territory:
    /order-unit unit_ids:FN-001 action:Patrol (land) path:1,1

    EXPECTED: Error about patrol path must contain at least two different territories

8A.3.4 Patrol with two different territories:
    /order-unit unit_ids:FN-001 action:Patrol (land) path:1,2

    EXPECTED: Success - patrol order created


--------------------------------------------------------------------------------
TEST 8A.4: Land vs Naval Validation
--------------------------------------------------------------------------------
PURPOSE: Test that land/naval actions match unit type

PREREQUISITES:
- Land unit (FN-001) in land territory
- Naval unit (SHIP-001) in water territory

STEPS:
8A.4.1 Land unit with naval action:
    /order-unit unit_ids:FN-001 action:Naval Transit path:1,2

    EXPECTED: Error about land unit with naval action

8A.4.2 Naval unit with land action:
    /order-unit unit_ids:SHIP-001 action:Transit (land) path:W1,W2

    EXPECTED: Error about naval unit with land action

8A.4.3 Naval unit on land:
    /order-unit unit_ids:SHIP-001 action:Naval Transit path:W1,1

    EXPECTED: Error about naval units cannot traverse land


--------------------------------------------------------------------------------
TEST 8A.5: Each Action Type
--------------------------------------------------------------------------------
PURPOSE: Verify each action type submits successfully

STEPS:
8A.5.1 Transit:
    /order-unit unit_ids:FN-001 action:Transit (land) path:1,2
    EXPECTED: Success

8A.5.2 Transport:
    /order-unit unit_ids:FN-001 action:Transport (land) path:1,2
    EXPECTED: Success

8A.5.3 Patrol:
    /order-unit unit_ids:FN-001 action:Patrol (land) path:1,2,3 speed:1
    EXPECTED: Success

8A.5.4 Raid:
    /order-unit unit_ids:FN-001 action:Raid path:1,2
    EXPECTED: Success

8A.5.5 Capture:
    /order-unit unit_ids:FN-001 action:Capture path:1,2
    EXPECTED: Success

8A.5.6 Siege (requires city at destination):
    /order-unit unit_ids:FN-001 action:Siege path:1,CITY
    EXPECTED: Success (or error if CITY is not city terrain)

8A.5.7-10 Naval variants:
    Naval Transit, Naval Convoy, Naval Patrol, Naval Transport
    Same patterns as land but with naval units in water territories


--------------------------------------------------------------------------------
TEST 8A.6: Authorization Scenarios
--------------------------------------------------------------------------------
PURPOSE: Test who can issue orders

STEPS:
8A.6.1 Owner can order own unit:
    (as unit owner)
    /order-unit unit_ids:MY-UNIT action:Transit (land) path:1,2
    EXPECTED: Success

8A.6.2 Commander can order assigned unit:
    (as commander of unit owned by someone else)
    /order-unit unit_ids:THEIR-UNIT action:Transit (land) path:1,2
    EXPECTED: Success

8A.6.3 Non-authorized cannot order:
    (as random character)
    /order-unit unit_ids:SOMEONES-UNIT action:Transit (land) path:1,2
    EXPECTED: Error about not authorized

8A.6.4 Faction COMMAND permission for faction units:
    (grant COMMAND permission first)
    /grant-faction-permission faction_id:test-fn character:test-member permission_type:COMMAND
    /order-unit unit_ids:FACTION-UNIT action:Transit (land) path:1,2
    EXPECTED: Success


--------------------------------------------------------------------------------
TEST 8A.7: Path Validation
--------------------------------------------------------------------------------
PURPOSE: Test path validation rules

STEPS:
8A.7.1 Path must start at current territory:
    (unit in territory 1)
    /order-unit unit_ids:FN-001 action:Transit (land) path:2,3
    EXPECTED: Error about path must start at current territory

8A.7.2 Non-adjacent territories:
    /order-unit unit_ids:FN-001 action:Transit (land) path:1,3
    EXPECTED: Error identifying which territories are not adjacent (e.g., "1 and 3")

8A.7.3 Nonexistent territory:
    /order-unit unit_ids:FN-001 action:Transit (land) path:1,999
    EXPECTED: Error about territory not found


--------------------------------------------------------------------------------
TEST 8A.8: Confirmation for Existing Orders
--------------------------------------------------------------------------------
PURPOSE: Test confirmation dialog when units have existing orders

STEPS:
8A.8.1 Submit first order:
    /order-unit unit_ids:FN-001 action:Transit (land) path:1,2
    EXPECTED: Success

8A.8.2 Submit second order without override:
    /order-unit unit_ids:FN-001 action:Raid path:1,2,3
    EXPECTED: Confirmation dialog showing existing order

8A.8.3 Click Cancel:
    EXPECTED: Order cancelled message, original order unchanged

8A.8.4 Submit again and click Confirm Override:
    /order-unit unit_ids:FN-001 action:Raid path:1,2,3
    EXPECTED: Success with "previous orders cancelled" note

8A.8.5 Verify:
    /my-orders
    EXPECTED: Only the raid order (transit was cancelled)


================================================================================
SECTION 8B: MOVEMENT PHASE TURN RESOLUTION
================================================================================

Tests for verifying the movement phase processes land unit movement correctly
during turn resolution. These tests focus on the turn resolution behavior
rather than order submission (which is covered in Section 8A).

--------------------------------------------------------------------------------
TEST 8B.1: Basic Transit Movement
--------------------------------------------------------------------------------
PURPOSE: Verify unit moves along path during turn resolution

PREREQUISITES:
- Unit FN-001 in territory 1 (plains)
- Territory 2 exists (plains, adjacent to 1)
- Unit has movement >= 1

SETUP:
    /order-unit unit_ids:FN-001 action:Transit (land) path:1,2

STEPS:
8B.1.1 Resolve turn:
    /resolve-turn

    EXPECTED:
    - Turn report shows TRANSIT_COMPLETE event
    - Unit moved from territory 1 to territory 2

8B.1.2 Verify unit position:
    /view-unit unit_id:FN-001

    EXPECTED: Current territory is 2


--------------------------------------------------------------------------------
TEST 8B.2: Movement Bonus (+1 for Transit)
--------------------------------------------------------------------------------
PURPOSE: Verify transit action gets +1 movement bonus

PREREQUISITES:
- Unit with movement=1 in territory 1
- Three adjacent territories: 1 -> 2 -> 3 (all plains)

SETUP:
    /order-unit unit_ids:FN-001 action:Transit (land) path:1,2,3

STEPS:
8B.2.1 Resolve turn:
    /resolve-turn

    EXPECTED:
    - Unit should reach territory 3 (movement 1 + bonus 1 = 2 steps)
    - TRANSIT_COMPLETE event in turn report

8B.2.2 Verify:
    /view-unit unit_id:FN-001

    EXPECTED: Current territory is 3


--------------------------------------------------------------------------------
TEST 8B.3: Terrain Costs (Mountains)
--------------------------------------------------------------------------------
PURPOSE: Verify mountains terrain costs 3 MP

PREREQUISITES:
- Unit with movement=2 (total 3 MP with transit bonus) in plains territory
- Adjacent mountain territory

SETUP:
    # Create mountain territory if needed
    /create-territory territory_id:MT1 terrain_type:mountains name:Test Mountains
    /add-adjacency territory_id_1:1 territory_id_2:MT1
    /order-unit unit_ids:FN-001 action:Transit (land) path:1,MT1

STEPS:
8B.3.1 Resolve turn:
    /resolve-turn

    EXPECTED: Unit moves to MT1 (cost 3, have 3 MP)

8B.3.2 Test with insufficient MP (unit with movement=1, total 2 MP):
    /order-unit unit_ids:SLOW-UNIT action:Transit (land) path:1,MT1

8B.3.3 Resolve turn:
    /resolve-turn

    EXPECTED:
    - Unit stays at territory 1
    - MOVEMENT_BLOCKED event in turn report
    - Order remains ONGOING


--------------------------------------------------------------------------------
TEST 8B.4: Multi-Turn Path
--------------------------------------------------------------------------------
PURPOSE: Verify long paths continue across multiple turns

PREREQUISITES:
- Unit with movement=1 (2 MP with bonus)
- Path of 5 territories: 1 -> 2 -> 3 -> 4 -> 5

SETUP:
    /order-unit unit_ids:FN-001 action:Transit (land) path:1,2,3,4,5

STEPS:
8B.4.1 Resolve turn 1:
    /resolve-turn

    EXPECTED:
    - Unit at territory 3 (2 steps)
    - TRANSIT_PROGRESS event (not COMPLETE)
    - Order status is ONGOING

8B.4.2 Resolve turn 2:
    /resolve-turn

    EXPECTED:
    - Unit at territory 5 (final destination)
    - TRANSIT_COMPLETE event
    - Order status is SUCCESS


--------------------------------------------------------------------------------
TEST 8B.5: Group Movement (Slowest Unit)
--------------------------------------------------------------------------------
PURPOSE: Verify group uses slowest unit's movement

PREREQUISITES:
- Fast unit (movement=4) and slow unit (movement=1) in same territory
- Path: 1 -> 2 -> 3 -> 4

SETUP:
    /order-unit unit_ids:FAST-UNIT,SLOW-UNIT action:Transit (land) path:1,2,3,4

STEPS:
8B.5.1 Resolve turn:
    /resolve-turn

    EXPECTED:
    - Both units at territory 3 (slowest movement 1 + bonus = 2 steps)
    - Both units move together

8B.5.2 Verify both units moved:
    /view-unit unit_id:FAST-UNIT
    /view-unit unit_id:SLOW-UNIT

    EXPECTED: Both show current territory as 3


--------------------------------------------------------------------------------
TEST 8B.6: Patrol Looping
--------------------------------------------------------------------------------
PURPOSE: Verify patrol orders loop indefinitely

PREREQUISITES:
- Unit with movement=2 (2 MP, no patrol bonus)
- Circular path: 1 -> 2 -> 3

SETUP:
    /order-unit unit_ids:FN-001 action:Patrol (land) path:1,2,3

STEPS:
8B.6.1 Resolve turn 1:
    /resolve-turn

    EXPECTED:
    - Unit at territory 3
    - TRANSIT_PROGRESS event (patrol never completes)
    - Order status is ONGOING

8B.6.2 Resolve turn 2:
    /resolve-turn

    EXPECTED:
    - Unit loops back to territory 2 (path resets at end)
    - Order still ONGOING
    - Patrol continues until replaced


--------------------------------------------------------------------------------
TEST 8B.7: Patrol Speed Limit
--------------------------------------------------------------------------------
PURPOSE: Verify patrol speed parameter limits movement per turn

PREREQUISITES:
- Unit with movement=4 (4 MP, no patrol bonus)
- Path: 1 -> 2 -> 3 -> 4

SETUP:
    /order-unit unit_ids:FN-001 action:Patrol (land) path:1,2,3,4 speed:2

STEPS:
8B.7.1 Resolve turn:
    /resolve-turn

    EXPECTED:
    - Unit at territory 3 (only 2 MP used due to speed limit)
    - 4 MP available but speed=2 limits movement


--------------------------------------------------------------------------------
TEST 8B.8: Co-location Validation Failure
--------------------------------------------------------------------------------
PURPOSE: Verify order fails if units aren't in same territory

PREREQUISITES:
- Unit A in territory 1
- Unit B in territory 2

SETUP:
    # Move units to different territories first
    /order-unit unit_ids:UNIT-A,UNIT-B action:Transit (land) path:1,2

STEPS:
8B.8.1 Resolve turn:
    /resolve-turn

    EXPECTED:
    - ORDER_FAILED event in turn report
    - Error message about units not co-located
    - Units don't move


--------------------------------------------------------------------------------
TEST 8B.9: Engagement Detection - Moving vs Moving (War)
--------------------------------------------------------------------------------
PURPOSE: Verify units from warring factions engage when meeting

PREREQUISITES:
- Two factions at war (use /declare-war to create war)
- Unit A from faction 1 in territory 1
- Unit B from faction 2 in territory 3
- Territory 2 between them

SETUP:
    # Create war between factions
    /order-declare-war target_faction_ids:test-ek objective:Test War

    # Create transit orders heading toward each other
    /order-unit unit_ids:FN-001 action:Transit (land) path:1,2,3
    /order-unit unit_ids:EK-001 action:Transit (land) path:3,2,1

STEPS:
8B.9.1 Resolve turn:
    /resolve-turn

    EXPECTED:
    - Both units meet at territory 2
    - ENGAGEMENT_DETECTED events for both units
    - Both units stop moving (ENGAGED status)
    - Orders remain ONGOING (not completed)


--------------------------------------------------------------------------------
TEST 8B.10: Engagement Detection - Moving vs Stationary (War)
--------------------------------------------------------------------------------
PURPOSE: Verify moving unit engages hostile stationary unit

PREREQUISITES:
- Two factions at war
- Moving unit from faction 1 in territory 1
- Stationary unit from faction 2 in territory 2

SETUP:
    # Ensure war exists between factions
    /declare-war target_faction:EK objective:Test War

    # Create transit order for faction 1 unit
    /order-unit unit_ids:FN-001 action:Transit (land) path:1,2

STEPS:
8B.10.1 Resolve turn:
    /resolve-turn

    EXPECTED:
    - Moving unit reaches territory 2
    - ENGAGEMENT_DETECTED event for moving unit
    - ENGAGEMENT_DETECTED event for stationary unit (owner notified)
    - Moving unit status becomes ENGAGED


--------------------------------------------------------------------------------
TEST 8B.11: Engagement Detection - Raid vs Defender
--------------------------------------------------------------------------------
PURPOSE: Verify raiding unit engages territory controller's units

PREREQUISITES:
- Faction 1 owns territory 2
- Faction 2 unit in territory 1 (NOT at war with faction 1)
- Faction 1 unit in territory 2

SETUP:
    # No war between factions - raiding creates engagement
    /order-unit unit_ids:F2-001 action:Raid (land) path:1,2

STEPS:
8B.11.1 Resolve turn:
    /resolve-turn

    EXPECTED:
    - Raiding unit reaches territory 2
    - ENGAGEMENT_DETECTED event with reason "raid_defense"
    - Defender notified of engagement


--------------------------------------------------------------------------------
TEST 8B.12: No Engagement - Friendly Units
--------------------------------------------------------------------------------
PURPOSE: Verify friendly units don't engage each other

PREREQUISITES:
- Two units from the same faction
- Unit A in territory 1
- Unit B in territory 2

SETUP:
    /order-unit unit_ids:FN-001 action:Transit (land) path:1,2

STEPS:
8B.12.1 Resolve turn:
    /resolve-turn

    EXPECTED:
    - Moving unit reaches territory 2
    - NO ENGAGEMENT_DETECTED events
    - TRANSIT_COMPLETE event (order succeeds normally)


--------------------------------------------------------------------------------
TEST 8B.13: Patrol Engagement - Basic
--------------------------------------------------------------------------------
PURPOSE: Test patrol intercepts hostile in adjacent territory

PREREQUISITES:
- Two factions at war (use /declare-war to create war)
- Patrol unit from faction 1 in territory 1
- Hostile unit from faction 2 in territory 2 (stationary)
- Territory 1 and 2 are adjacent

SETUP:
    # Create war between factions
    /order-declare-war target_faction_ids:test-ek objective:Patrol Test

    # Create patrol order for faction 1 unit
    /order-unit unit_ids:FN-001 action:Patrol (land) path:1,2,3

    # Hostile unit at territory 2 (no movement order - stationary)

STEPS:
8B.13.1 Resolve turn:
    /resolve-turn

    EXPECTED:
    - Patrol unit moves from territory 1 to territory 2
    - PATROL_ENGAGEMENT event for patrol unit (showing interception)
    - PATROL_ENGAGEMENT event for hostile unit (showing being intercepted)
    - Both units become ENGAGED
    - Patrol order status ONGOING (interrupted by engagement)


--------------------------------------------------------------------------------
TEST 8B.14: Patrol Engagement - Insufficient MP
--------------------------------------------------------------------------------
PURPOSE: Test patrol does not engage if terrain cost exceeds MP

PREREQUISITES:
- Two factions at war
- Patrol unit with 2 MP in territory 1
- Hostile unit in territory 2 (mountain terrain, cost 3)
- Territory 1 and 2 are adjacent

SETUP:
    # Create war between factions
    /order-declare-war target_faction_ids:test-ek objective:MP Test

    # Create patrol order (unit has 2 MP, mountain costs 3)
    /order-unit unit_ids:FN-001 action:Patrol (land) path:1,2

STEPS:
8B.14.1 Resolve turn:
    /resolve-turn

    EXPECTED:
    - NO PATROL_ENGAGEMENT events
    - Patrol unit stays at territory 1 (can't afford terrain cost)
    - Normal patrol behavior continues


--------------------------------------------------------------------------------
TEST 8B.15: Patrol Engagement - Multiple Targets (Tiebreak)
--------------------------------------------------------------------------------
PURPOSE: Test tiebreaking with multiple hostiles in different territories

PREREQUISITES:
- Two factions at war
- Patrol unit with 3 MP at territory 1
- Hostile A at territory 2 (plains, cost 1)
- Hostile B at territory 3 (plains, cost 1)
- Both territory 2 and 3 adjacent to territory 1
- Territory 2 < territory 3 alphabetically

SETUP:
    # Create war and patrol with multiple adjacent hostiles
    /order-declare-war target_faction_ids:test-ek objective:Tiebreak Test
    /order-unit unit_ids:FN-001 action:Patrol (land) path:1,2,3

STEPS:
8B.15.1 Resolve turn:
    /resolve-turn

    EXPECTED:
    - Patrol engages hostile in alphabetically-first territory (2 before 3)
    - PATROL_ENGAGEMENT event shows engagement at territory 2
    - Hostile at territory 3 is NOT engaged


--------------------------------------------------------------------------------
TEST 8B.16: Patrol Engagement - Moving Hostile
--------------------------------------------------------------------------------
PURPOSE: Test patrol intercepts moving hostile unit

PREREQUISITES:
- Two factions at war
- Patrol unit from faction 1 in territory 1
- Moving unit from faction 2 transiting through territory 2
- Territory 1 and 2 are adjacent

SETUP:
    # Create war between factions
    /order-declare-war target_faction_ids:test-ek objective:Moving Hostile Test

    # Create patrol order for faction 1
    /order-unit unit_ids:FN-001 action:Patrol (land) path:1,2,3

    # Create transit order for hostile (moving through)
    /order-unit unit_ids:EK-001 action:Transit (land) path:2,3,4

STEPS:
8B.16.1 Resolve turn:
    /resolve-turn

    EXPECTED:
    - Patrol moves to intercept hostile at territory 2
    - PATROL_ENGAGEMENT events for both units
    - Both units become ENGAGED
    - Hostile's transit order interrupted


================================================================================
SECTION 9: PLAYER VIEW COMMANDS
================================================================================

Note: These require a character linked to your Discord account
You can assign one via right clicking on your username, clicking App Commands
Then clicking assign character. Recommend you assign test-leader

--------------------------------------------------------------------------------
TEST 9.1: /my-resources
--------------------------------------------------------------------------------
PURPOSE: View your character's resources

STEPS:
9.1.1 View resources:
    /my-resources

    EXPECTED: Ephemeral embed showing your resource inventory

9.1.2 If no character:
    EXPECTED: Error about not having a character


--------------------------------------------------------------------------------
TEST 9.2: /my-faction
--------------------------------------------------------------------------------
PURPOSE: View your faction membership(s)

NOTE: Characters can now be members of multiple factions. The embed shows:
- Which faction you're currently representing
- All your faction memberships with join turns
- Representation change cooldown status

STEPS:
9.2.1 If in one faction:
    /my-faction

    EXPECTED: Embed showing:
    - Represented faction details
    - Member list
    - Faction ID

9.2.2 If in multiple factions:
    /my-faction

    EXPECTED: Embed showing:
    - Which faction you're representing
    - "All Memberships" section with:
      - Each faction name and ID
      - Join turn for each
      - Which is represented
      - Which you lead (if any)
    - Cooldown status (if recently changed)

9.2.3 If not in a faction:
    EXPECTED: Error message


--------------------------------------------------------------------------------
TEST 9.3: /my-units
--------------------------------------------------------------------------------
PURPOSE: View units you own or command

STEPS:
9.3.1 View units:
    /my-units

    EXPECTED: Embed with:
    - Owned units section
    - Commanded units section
    - Disbanded units section


--------------------------------------------------------------------------------
TEST 9.4: /my-units-list
--------------------------------------------------------------------------------
PURPOSE: Get simple list of unit IDs

STEPS:
9.4.1 Get list:
    /my-units-list

    EXPECTED: Simple text message with comma-separated unit IDs


--------------------------------------------------------------------------------
TEST 9.5: /my-territories
--------------------------------------------------------------------------------
PURPOSE: View territories you control

STEPS:
9.5.1 View territories:
    /my-territories

    EXPECTED: Embed with controlled territories


--------------------------------------------------------------------------------
TEST 9.6: /my-territories-list
--------------------------------------------------------------------------------
PURPOSE: Get simple list of territory IDs

STEPS:
9.6.1 Get list:
    /my-territories-list

    EXPECTED: Simple text with territory IDs


--------------------------------------------------------------------------------
TEST 9.7: /my-victory-points
--------------------------------------------------------------------------------
PURPOSE: View your victory points

STEPS:
9.7.1 View VPs:
    /my-victory-points

    EXPECTED: Embed showing personal and faction VP totals


--------------------------------------------------------------------------------
TEST 9.8: /my-orders
--------------------------------------------------------------------------------
PURPOSE: View your pending and ongoing orders

STEPS:
9.8.1 View orders:
    /my-orders

    EXPECTED: Embed showing pending and ongoing orders

================================================================================
SECTION 10: ALLIANCE MANAGEMENT
================================================================================

--------------------------------------------------------------------------------
TEST 10.1: /view-alliances
--------------------------------------------------------------------------------
PURPOSE: View all alliances

STEPS:
10.1.1 View alliances:
    /view-alliances

    EXPECTED: Embed showing alliances with:
    - Participating factions
    - Status (ACTIVE or PENDING)

--------------------------------------------------------------------------------
TEST 10.2: /edit-alliance (Admin)
--------------------------------------------------------------------------------
PURPOSE: Edit alliance status

STEPS:
10.2.1 Edit status:
    /edit-alliance faction_a_id:fire-nation faction_b_id:earth-kingdom status:PENDING_FACTION_A

    EXPECTED: Success message

10.4.2 Verify:
    /view-alliances

    EXPECTED: Alliance should have pending status


--------------------------------------------------------------------------------
TEST 10.3: /delete-alliance (Admin)
--------------------------------------------------------------------------------
PURPOSE: Delete an alliance

STEPS:
10.3.1 Delete:
    /delete-alliance faction_a_id:fire-nation faction_b_id:earth-kingdom

    EXPECTED: Success message

10.3.2 Verify:
    /view-alliances

    EXPECTED: Alliance should not show


--------------------------------------------------------------------------------
TEST 10.4: /add-alliance (Admin)
--------------------------------------------------------------------------------
PURPOSE: Create an active alliance

STEPS:
10.4.1 Create alliance:
    /add-alliance faction_a_id:fire-nation faction_b_id:earth-kingdom

    EXPECTED: Success message

10.4.2 Verify:
    /view-alliances

    EXPECTED: New alliance should appear


--------------------------------------------------------------------------------
TEST 10.5: /order-dissolve-alliance
--------------------------------------------------------------------------------
PURPOSE: Dissolve an active alliance (faction leader only)

SETUP: Ensure alliance exists between fire-nation and earth-kingdom (from TEST 10.4)
       Ensure current turn >= 4 (resolve turns if needed)
       Wait 4 turns after alliance activation (resolve additional turns if needed)

STEPS:
10.5.1 Try dissolving too early (within first 4 turns of game):
    - If current turn < 4:
    /order-dissolve-alliance target_faction_id:earth-kingdom

    EXPECTED: Error message about being within first 4 turns of the game

10.5.2 Try dissolving within 4 turns of alliance:
    - If alliance was activated < 4 turns ago:
    /order-dissolve-alliance target_faction_id:earth-kingdom

    EXPECTED: Error message about alliance being too new (must be at least 4 turns old)

10.5.3 Successfully submit dissolve order:
    - Ensure turn >= 4 AND alliance is >= 4 turns old
    /order-dissolve-alliance target_faction_id:earth-kingdom

    EXPECTED: Success message about order submitted

10.5.4 Resolve turn:
    /resolve-turn

    EXPECTED: Note in turn report that alliance was dissolved

10.5.5 Verify:
    /view-alliances

    EXPECTED: Alliance should no longer appear

CLEANUP:
    /add-alliance faction_a_id:fire-nation faction_b_id:earth-kingdom
    (if needed for subsequent tests)


================================================================================
SECTION 11: WAR MANAGEMENT
================================================================================

SETUP: Create factions,
/create-faction faction_id:north-water name:Northern Water Tribe
/create-faction faction_id:south-water name:Southern Water Tribe


--------------------------------------------------------------------------------
TEST 11.1: /view-wars
--------------------------------------------------------------------------------
PURPOSE: View all wars

STEPS:
11.1.1 View wars:
    /view-wars

    EXPECTED: Embed showing wars with:
    - War ID
    - Objective
    - Sides (participating factions)
    - Declared turn


--------------------------------------------------------------------------------
TEST 11.2: /edit-war (Admin)
--------------------------------------------------------------------------------
PURPOSE: Edit war objective

PREREQUISITE: A war exists (created via /order-declare-war and turn resolution)

STEPS:
11.2.1 Edit objective:
    /edit-war war_id:WAR-0001 objective:New objective text

    EXPECTED: Success message

11.2.2 Verify:
   /view-wars

   EXPECTED: Updated objective text


--------------------------------------------------------------------------------
TEST 11.3: /add-war-participant (Admin)
--------------------------------------------------------------------------------
PURPOSE: Add faction to a war

STEPS:
11.3.1 Add to Side A:
    /add-war-participant war_id:WAR-0001 faction_id:north-water side:Side A

    EXPECTED: Success message

11.3.2 Add to Side B:
    /add-war-participant war_id:WAR-0001 faction_id:south-water side:Side B

    EXPECTED: Success message

11.3.3 Verify:
   /view-wars

   EXPECTED: New participants on the relevant sides

11.3.4 Try to add to Side A:
    /add-war-participant war_id:WAR-0001 faction_id:north-water side:Side A

    EXPECTED: Error that they are already in the war

11.3.5 Try to add to Side B:
    /add-war-participant war_id:WAR-0001 faction_id:north-water side:Side B

    EXPECTED: Error that they are already in the war



--------------------------------------------------------------------------------
TEST 11.4: /remove-war-participant (Admin)
--------------------------------------------------------------------------------
PURPOSE: Remove faction from war

STEPS:
11.4.1 Remove:
    /remove-war-participant war_id:WAR-0001 faction_id:earth-kingdom

    EXPECTED: Success message

11.4.2 Verify:
   /view-wars

   EXPECTED: Updated participants list


--------------------------------------------------------------------------------
TEST 11.5: /delete-war (Admin)
--------------------------------------------------------------------------------
PURPOSE: Delete a war entirely

STEPS:
11.5.1 Delete:
    /delete-war war_id:WAR-0001

    EXPECTED: Success message

11.5.2 Verify:
   /view-wars

   EXPECTED: No active wars message


================================================================================
SECTION 12: VICTORY POINTS (Admin)
================================================================================

--------------------------------------------------------------------------------
TEST 12.1: /view-victory-points (Admin)
--------------------------------------------------------------------------------
PURPOSE: View faction victory points

STEPS:
12.1.1 View for a faction:
    /view-victory-points faction_id:fire-nation

    EXPECTED: Embed showing:
    - Faction total VPs
    - Individual member VPs
    - Assigned VPs

================================================================================
SECTION 13: FACTION SPENDING
================================================================================

Tests for faction per-turn spending feature. Spending is deducted from faction
resources during the upkeep phase, before unit upkeep.

--------------------------------------------------------------------------------
TEST 13.1: /edit-faction-spending (Admin)
--------------------------------------------------------------------------------
PURPOSE: Set faction per-turn spending

STEPS:
13.1.1 Edit spending:
    /edit-faction-spending faction_id:fire-nation ore:5 rations:10

    EXPECTED: Success message showing new spending values (ore: 5, rations: 10)

13.1.2 Verify with view:
    /view-faction-spending faction_id:fire-nation

    EXPECTED: Shows ore:5, rations:10, others:0

13.1.3 Clear spending:
    /edit-faction-spending faction_id:fire-nation ore:0 rations:0

    EXPECTED: Success message about cleared spending

13.1.4 Try negative spending:
    /edit-faction-spending faction_id:fire-nation ore:-5

    EXPECTED: Error about spending must be >= 0

13.1.5 Try nonexistent faction:
    /edit-faction-spending faction_id:nonexistent ore:5

    EXPECTED: Error about faction not found


--------------------------------------------------------------------------------
TEST 13.2: Faction Spending Turn Resolution
--------------------------------------------------------------------------------
PURPOSE: Verify spending deduction during upkeep phase

SETUP:
    /edit-faction-spending faction_id:fire-nation ore:10 rations:20
    /modify-faction-resources faction_id:fire-nation ore:15 rations:15

STEPS:
13.3.1 Resolve turn:
    /resolve-turn

    EXPECTED:
    - Turn report shows FACTION_SPENDING event for fire-nation
    - Spent: ore:10, rations:15 (only had 15 rations)
    - Warning about partial spending (shortfall: 5 rations)

13.3.2 Verify resources after turn:
    /view-faction-resources faction_id:fire-nation

    EXPECTED: ore:5 (15-10), rations:0 (15-15, capped at available)

CLEANUP:
    /edit-faction-spending faction_id:fire-nation ore:0 rations:0


================================================================================
SECTION 14: FACTION REPRESENTATION (Multi-Faction Membership)
================================================================================

PURPOSE: Test the multi-faction membership and representation system

SETUP:
- Create two factions: fire-nation, earth-kingdom
- Create two characters: test-leader, test-member
- Ensure test-member is NOT in any faction initially


--------------------------------------------------------------------------------
TEST 14.1: /set-representation - Change represented faction
--------------------------------------------------------------------------------
PURPOSE: Change which faction you publicly represent (has 3-turn cooldown)

SETUP:
- /add-faction-member faction_id:fire-nation character:test-member
- /add-faction-member faction_id:earth-kingdom character:test-member
- Switch to test-member character

STEPS:
14.1.1 Check current representation:
    /my-faction

    EXPECTED: Representing fire-nation (first faction joined)

14.1.2 Change representation:
    /set-representation faction_id:earth-kingdom

    EXPECTED: Success message, now representing earth-kingdom

14.1.3 Try to change again immediately (cooldown):
    /set-representation faction_id:fire-nation

    EXPECTED: Error - cooldown not expired (3 turns remaining)

14.1.4 Advance 3 turns and try again:
    /resolve-turn (x3)
    /set-representation faction_id:fire-nation

    EXPECTED: Success - cooldown expired

14.1.5 Try representing a faction you're not a member of:
    /set-representation faction_id:nonexistent

    EXPECTED: Error - not a member of that faction


--------------------------------------------------------------------------------
TEST 14.2: /admin-set-representation - Admin bypass cooldown
--------------------------------------------------------------------------------
PURPOSE: Admin can force-set representation bypassing cooldown

STEPS:
14.2.1 Admin set representation (even during cooldown):
    /admin-set-representation character:test-member faction_id:earth-kingdom

    EXPECTED: Success with "[Admin override]" message

14.2.2 Verify no cooldown applied to admin changes:
    /admin-set-representation character:test-member faction_id:fire-nation

    EXPECTED: Success - no cooldown for admin commands


--------------------------------------------------------------------------------
TEST 14.3: Auto-representation on first faction join
--------------------------------------------------------------------------------
PURPOSE: First faction join auto-sets representation

SETUP: Create a new character not in any faction (test-newbie)

STEPS:
14.3.1 Join first faction:
    /add-faction-member faction_id:fire-nation character:test-newbie

    EXPECTED: Success with "now representing this faction"

14.3.2 Verify representation was auto-set:
    Switch to test-newbie
    /my-faction

    EXPECTED: Representing fire-nation


--------------------------------------------------------------------------------
TEST 14.4: Auto-reassignment when leaving represented faction
--------------------------------------------------------------------------------
PURPOSE: Leaving represented faction auto-assigns to most recent remaining

SETUP:
- test-member in fire-nation (joined turn 1) and earth-kingdom (joined turn 5)
- Representing fire-nation

STEPS:
14.4.1 Leave represented faction:
    /order-leave-faction faction_id:fire-nation
    /resolve-turn

    EXPECTED: Success, now representing earth-kingdom (most recent join)

14.4.2 Verify auto-assignment doesn't reset cooldown:
    /my-faction

    EXPECTED: No cooldown message (auto-assignment doesn't start cooldown)


--------------------------------------------------------------------------------
TEST 14.5: Kick from represented faction resets cooldown
--------------------------------------------------------------------------------
PURPOSE: Being kicked from represented faction resets the representation cooldown

SETUP:
- test-member in fire-nation and earth-kingdom
- Representing fire-nation
- Switch to faction leader

STEPS:
14.5.1 Kick member from represented faction:
    /order-kick-from-faction target_character:test-member
    /resolve-turn

    EXPECTED: test-member auto-assigned to earth-kingdom

14.5.2 Verify cooldown was reset:
    Switch to test-member
    /set-representation faction_id:fire-nation  (rejoin first)
    /set-representation faction_id:earth-kingdom

    EXPECTED: Error - cooldown active (kick reset the timer)


================================================================================
SECTION 15: UNIT OBSERVATION EVENTS
================================================================================

Unit observation events are generated during the movement phase. Units can observe
other units in their territory (distance 0), adjacent territories (distance 1),
and for scouts, territories at distance 2.

Infiltrators cannot be observed by anyone, but can observe others.

--------------------------------------------------------------------------------
TEST 15.1: Basic Observation Setup
--------------------------------------------------------------------------------
PURPOSE: Set up units for observation testing

STEPS:
15.1.1 Create test config:
    /create-test-config

    EXPECTED: Test configuration created including scout and infiltrator units

15.1.2 Verify scout unit exists:
    /view-unit unit_id:FN-SCOUT-001

    EXPECTED: Fire Nation Scout unit visible with scout keyword

15.1.3 Verify infiltrator unit exists:
    /view-unit unit_id:EK-INF-001

    EXPECTED: Earth Kingdom Infiltrator unit visible with infiltrator keyword


--------------------------------------------------------------------------------
TEST 15.2: Adjacent Territory Observation
--------------------------------------------------------------------------------
PURPOSE: Test that units observe other units in adjacent territories

SETUP:
- FN-001 in territory 1
- EK-001 in territory 2
- Territories 1 and 2 are adjacent

STEPS:
15.2.1 Resolve turn with no movement orders:
    /resolve-turn

    EXPECTED: Turn report shows UNIT_OBSERVED events where:
    - FN-001 owner sees EK-001 (adjacent)
    - EK-001 owner sees FN-001 (adjacent)

15.2.2 Check test-zuko's turn report:
    Switch to test-zuko
    /my-turn-report

    EXPECTED: Shows observation of Earth Kingdom units in adjacent territory 2


--------------------------------------------------------------------------------
TEST 15.3: Scout Extended Range (Distance 2)
--------------------------------------------------------------------------------
PURPOSE: Test that scouts can observe units 2 territories away

SETUP:
- FN-SCOUT-001 (scout) in territory 1
- Territory 1 -> Territory 2 -> CITY (Ba Sing Se) adjacency chain

STEPS:
15.3.1 Move an enemy unit to CITY:
    [Use admin commands to place a unit in CITY territory]

15.3.2 Resolve turn:
    /resolve-turn

    EXPECTED: Scout owner (test-zuko) sees unit in CITY at distance 2


--------------------------------------------------------------------------------
TEST 15.4: Infiltrator Invisibility
--------------------------------------------------------------------------------
PURPOSE: Test that infiltrators cannot be observed

SETUP:
- EK-INF-001 (infiltrator) in territory 2
- FN-001 in territory 1 (adjacent to territory 2)

STEPS:
15.4.1 Resolve turn:
    /resolve-turn

    EXPECTED:
    - FN-001 owner does NOT see EK-INF-001 in turn report
    - EK-INF-001 owner (test-toph) DOES see FN-001 in turn report
    (Infiltrators are invisible but can still observe)


--------------------------------------------------------------------------------
TEST 15.5: Observation During Movement
--------------------------------------------------------------------------------
PURPOSE: Test that observation events are generated as units move

SETUP:
- FN-001 in territory 1
- EK-001 in territory 3 (adjacent to territory 2 but not territory 1)

STEPS:
15.5.1 Order FN-001 to transit through territory 2:
    /order-unit action:transit path:1,2,3

15.5.2 Resolve turn:
    /resolve-turn

    EXPECTED: Turn report shows:
    - FN-001 observed EK-001 when entering territory 2 (if adjacent)
    - Or when arriving at territory 3 (same territory)


--------------------------------------------------------------------------------
TEST 15.6: Owner Exclusion
--------------------------------------------------------------------------------
PURPOSE: Test that unit owners don't receive observations of their own units

SETUP:
- test-zuko owns FN-001 and FN-002
- Both units in territory 1

STEPS:
15.6.1 Resolve turn:
    /resolve-turn

15.6.2 Check test-zuko's turn report:
    /my-turn-report

    EXPECTED: test-zuko does NOT see observations of their own units


================================================================================
SECTION 16: TRANSPORT ORDERS
================================================================================

Tests for land and naval transport functionality.

--------------------------------------------------------------------------------
TEST 16.1: Transport - Basic Flow
--------------------------------------------------------------------------------
PURPOSE: Test complete transport cycle

SETUP:
1. Create territories with water and land:
    /create-territory territory_id:TL1 terrain_type:plains name:Coast Origin
    /create-territory territory_id:TW1 terrain_type:ocean name:Water 1
    /create-territory territory_id:TW2 terrain_type:ocean name:Water 2
    /create-territory territory_id:TW3 terrain_type:ocean name:Water 3
    /create-territory territory_id:TL2 terrain_type:plains name:Coast Destination

2. Set adjacencies:
    /add-adjacency territory_id_1:TL1 territory_id_2:TW1
    /add-adjacency territory_id_1:TW1 territory_id_2:TW2
    /add-adjacency territory_id_1:TW2 territory_id_2:TW3
    /add-adjacency territory_id_1:TW3 territory_id_2:TL2

3. Create units:
    - Naval transport SHIP-001 at TW1, capacity=5, movement=2
    - Land unit UNIT-001 at TL1, size=2

STEPS:
16.1.1 Submit naval transport order:
    /order-unit unit_ids:SHIP-001 action:Naval Transit path:TW1,TW2,TW3 
    EXPECTED: Order confirmed

16.1.2 Submit land transport order:
    /order-unit unit_ids:FN-001 action:Transport (land) path:TL1,TW1,TW2,TW3,TL2

    EXPECTED: Order confirmed with water_path, coast_territory, disembark_territory extracted

16.1.3 Resolve Turn 1:
    /resolve-turn

    EXPECTED (Turn 1):
    - UNIT-001 boards at TW1 (TRANSPORT_BOARDING event)
    - UNIT-001 moves through water (transport MP = 2+1 = 3)
    - UNIT-001 at TW3 by end of turn (moved 3 water tiles in 3 ticks)
    - SHIP-001 stays at TW1 (naval doesn't move yet)

16.1.4 Resolve Turn 2:
    /resolve-turn

    EXPECTED (Turn 2):
    - UNIT-001 disembarks to TL2 (TRANSPORT_DISEMBARK event)
    - UNIT-001 can continue moving on land if it has more destinations


--------------------------------------------------------------------------------
TEST 16.2: Transport - Capacity Insufficient
--------------------------------------------------------------------------------
PURPOSE: Test boarding fails with insufficient capacity

SETUP:
1. Naval unit with capacity=2
2. Land unit with size=5

STEPS:
16.2.1 Submit orders as in 16.1

16.2.2 Resolve turn:
    /resolve-turn

    EXPECTED:
    - Land unit waits at coast (TRANSPORT_WAITING event)
    - Reason: "no_matching_naval" (capacity check failed)


--------------------------------------------------------------------------------
TEST 16.3: Transport - Allied Factions
--------------------------------------------------------------------------------
PURPOSE: Test boarding works with allied factions

SETUP:
1. Create alliance between Faction A and B:
    - Faction A: /make-alliance target_faction:FactionB
    - Faction B: /make-alliance target_faction:FactionA
    /resolve-turn  (to form alliance)

2. Naval unit owned by Faction A
3. Land unit owned by Faction B
4. Same paths as TEST 16.1

STEPS:
16.3.1 Submit orders and resolve turn

    EXPECTED: Boarding succeeds (same as 16.1)


--------------------------------------------------------------------------------
TEST 16.4: Transport - Path Mismatch
--------------------------------------------------------------------------------
PURPOSE: Test boarding fails with mismatched paths

SETUP:
1. Naval transport path: TW1,TW2,TW3
2. Land transport water path: TW1,TW2,TW4 (different destination)

STEPS:
16.4.1 Submit orders and resolve turn

    EXPECTED:
    - Land unit waits (TRANSPORT_WAITING event)
    - Reason: "no_matching_naval" (path mismatch)


--------------------------------------------------------------------------------
TEST 16.5: Transport - Path Validation
--------------------------------------------------------------------------------
PURPOSE: Test transport path validation rules

STEPS:
16.5.1 Try path starting with water:
    /unit-order units:UNIT-001 action:transport path:TW1,TW2,TL2

    EXPECTED: Error - "must start with a land territory"

16.5.2 Try path ending with water:
    /unit-order units:UNIT-001 action:transport path:TL1,TW1,TW2

    EXPECTED: Error - "must end with a land territory"

16.5.3 Try path with non-contiguous water:
    /unit-order units:UNIT-001 action:transport path:TL1,TW1,TL2,TW2,TL3

    EXPECTED: Error - "water section must be contiguous"


--------------------------------------------------------------------------------
TEST 16.6: Transport - Multi-Turn Persistence
--------------------------------------------------------------------------------
PURPOSE: Test that transport state persists across turns

SETUP:
- Long water path that takes more than one turn

STEPS:
16.6.1 Submit orders with long path (e.g., 5 water territories)

16.6.2 Resolve Turn 1:
    /resolve-turn

    EXPECTED:
    - Land unit boards and moves some distance
    - Order status ONGOING with water_path_index saved

16.6.3 Check order status:
    /list-orders

    EXPECTED: Order shows as ONGOING with progress

16.6.4 Resolve Turn 2:
    /resolve-turn

    EXPECTED:
    - Land unit continues through water
    - Disembarks when reaching destination


================================================================================
SECTION 17: COMBAT PHASE
================================================================================

Tests for land combat during turn resolution. Combat occurs when hostile units
occupy the same territory after the movement phase.

--------------------------------------------------------------------------------
TEST 17.1: Basic Combat - War-Based Hostility
--------------------------------------------------------------------------------
PURPOSE: Test combat between factions at war

SETUP:
1. Create factions and put them at war:
    /create-faction faction_id:combat-fn name:Fire Nation (Combat Test)
    /create-faction faction_id:combat-ek name:Earth Kingdom (Combat Test)
    /add-faction-member faction_id:combat-fn character:test-leader
    /add-faction-member faction_id:combat-ek character:test-member
    /set-faction-leader faction_id:combat-fn leader:test-leader
    /set-faction-leader faction_id:combat-ek leader:test-member
    /order-declare-war target_faction_ids:combat-ek objective:Combat Test
    /resolve-turn  (to activate war)

2. Create territories:
    /create-territory territory_id:COMB-1 terrain_type:plains name:Combat Zone
    /create-territory territory_id:COMB-2 terrain_type:plains name:Retreat Zone
    /add-adjacency territory_id_1:COMB-1 territory_id_2:COMB-2

3. Create units in same territory:
    /create-unit unit_id:FN-COMB-001 unit_type:infantry territory_id:COMB-1 owner:test-leader
    /edit-unit unit_id:FN-COMB-001 attack:10 defense:5 organization:10
    /create-unit unit_id:EK-COMB-001 unit_type:infantry territory_id:COMB-1 owner:test-member
    /edit-unit unit_id:EK-COMB-001 attack:3 defense:3 organization:10

STEPS:
17.1.1 Resolve turn:
    /resolve-turn

    EXPECTED:
    - GM report shows COMBAT_STARTED at COMB-1
    - COMBAT_ORG_DAMAGE for EK-COMB-001 (FN attack 10 > EK defense 3)
    - NO damage to FN-COMB-001 (EK attack 3 <= FN defense 5)
    - COMBAT_RETREAT or unit moves to COMB-2
    - COMBAT_ENDED event

17.1.2 Verify unit states:
    /view-unit unit_id:EK-COMB-001

    EXPECTED: Organization reduced (was 10, now 8 or less)


--------------------------------------------------------------------------------
TEST 17.2: Organization Damage - Attack vs Defense
--------------------------------------------------------------------------------
PURPOSE: Test org damage only occurs when attack > defense

SETUP:
    - Unit A: attack=5, defense=5
    - Unit B: attack=5, defense=5
    - Both from opposing factions at war in same territory

STEPS:
17.2.1 Resolve turn:
    /resolve-turn

    EXPECTED:
    - NO COMBAT_ORG_DAMAGE events (5 is not > 5)
    - Both units stay at full organization


--------------------------------------------------------------------------------
TEST 17.3: Unit Disbandment
--------------------------------------------------------------------------------
PURPOSE: Test units disband when organization reaches 0

SETUP:
    - Strong unit: attack=20, defense=10, organization=10
    - Weak unit: attack=1, defense=1, organization=2

STEPS:
17.3.1 Resolve turn:
    /resolve-turn

    EXPECTED:
    - COMBAT_UNIT_DISBANDED for weak unit
    - Weak unit status becomes DISBANDED

17.3.2 Verify:
    /view-unit unit_id:WEAK-UNIT

    EXPECTED: Status = DISBANDED, organization <= 0


--------------------------------------------------------------------------------
TEST 17.4: Territory Capture (Rural)
--------------------------------------------------------------------------------
PURPOSE: Test rural territory capture after combat

SETUP:
1. Create rural territory controlled by faction B:
    /create-territory territory_id:RURAL-CAP terrain_type:plains name:Rural Target
    /edit-territory territory_id:RURAL-CAP controller_faction:combat-ek

2. Place building in territory:
    /create-building building_id:RURAL-BLDG building_type:barracks territory_id:RURAL-CAP

3. Create attacking unit with capture order:
    /create-unit unit_id:CAP-ATTACKER unit_type:infantry territory_id:RURAL-CAP owner:test-leader
    /edit-unit unit_id:CAP-ATTACKER attack:20 defense:10 organization:10
    /order-unit unit_ids:CAP-ATTACKER action:Capture path:RURAL-CAP

4. Create weak defender:
    /create-unit unit_id:CAP-DEFENDER unit_type:infantry territory_id:RURAL-CAP owner:test-member
    /edit-unit unit_id:CAP-DEFENDER attack:1 defense:1 organization:2

STEPS:
17.4.1 Resolve turn:
    /resolve-turn

    EXPECTED:
    - TERRITORY_CAPTURED event for RURAL-CAP
    - New controller is attacker's owner
    - BUILDING_COMBAT_DAMAGE event (durability -1)

17.4.2 Verify territory controller:
    /view-territory territory_id:RURAL-CAP

    EXPECTED: Controller changed to attacker's faction/character

17.4.3 Verify building damage:
    /view-building building_id:RURAL-BLDG

    EXPECTED: Durability reduced by 1


--------------------------------------------------------------------------------
TEST 17.5: City Territory NOT Captured
--------------------------------------------------------------------------------
PURPOSE: Test city territories are NOT captured in combat phase

SETUP:
1. Create city territory:
    /create-territory territory_id:CITY-TEST terrain_type:city name:Test City
    /edit-territory territory_id:CITY-TEST controller_faction:combat-ek

2. Place strong attacker with capture order:
    /create-unit unit_id:CITY-ATK unit_type:infantry territory_id:CITY-TEST owner:test-leader
    /edit-unit unit_id:CITY-ATK attack:20 defense:10 organization:10
    /order-unit unit_ids:CITY-ATK action:Capture path:CITY-TEST

3. Place weak defender:
    /create-unit unit_id:CITY-DEF unit_type:infantry territory_id:CITY-TEST owner:test-member
    /edit-unit unit_id:CITY-DEF attack:1 defense:1 organization:2

STEPS:
17.5.1 Resolve turn:
    /resolve-turn

    EXPECTED:
    - Combat occurs (COMBAT_STARTED, COMBAT_ENDED)
    - NO TERRITORY_CAPTURED event
    - City remains under original controller

17.5.2 Verify:
    /view-territory territory_id:CITY-TEST

    EXPECTED: Controller unchanged (still combat-ek)


--------------------------------------------------------------------------------
TEST 17.6: Action-Based Hostility (Neutral Factions)
--------------------------------------------------------------------------------
PURPOSE: Test combat between neutral factions with conflicting capture orders

SETUP:
1. Create two factions NOT at war:
    /create-faction faction_id:neutral-a name:Neutral A
    /create-faction faction_id:neutral-b name:Neutral B
    (Do NOT declare war between them)

2. Create territory and units:
    /create-territory territory_id:NEUTRAL-ZONE terrain_type:plains name:Contested Zone
    /create-unit unit_id:NA-001 unit_type:infantry territory_id:NEUTRAL-ZONE owner:neutral-a-char
    /create-unit unit_id:NB-001 unit_type:infantry territory_id:NEUTRAL-ZONE owner:neutral-b-char

3. Give both capture orders:
    (as neutral-a-char)
    /order-unit unit_ids:NA-001 action:Capture path:NEUTRAL-ZONE
    (as neutral-b-char)
    /order-unit unit_ids:NB-001 action:Capture path:NEUTRAL-ZONE

STEPS:
17.6.1 Resolve turn:
    /resolve-turn

    EXPECTED:
    - COMBAT_STARTED event
    - COMBAT_ACTION_CONFLICT event with recommendation text
    - Combat resolves normally
    - No war is declared (action conflict is temporary)

17.6.2 Check turn report:
    /gm-turn-report

    EXPECTED: "Action conflict" message with recommendation to coordinate


--------------------------------------------------------------------------------
TEST 17.7: Allied Factions Combine Stats
--------------------------------------------------------------------------------
PURPOSE: Test allied factions fight as one side

SETUP:
1. Create alliance between Faction A and B:
    /add-alliance faction_a_id:ally-a faction_b_id:ally-b

2. Put both at war with Faction C:
    /order-declare-war target_faction_ids:enemy-c

3. Place units:
    - Ally A unit: attack=3, defense=3 in territory T
    - Ally B unit: attack=4, defense=4 in territory T
    - Enemy C unit: attack=5, defense=5 in territory T

STEPS:
17.7.1 Resolve turn:
    /resolve-turn

    EXPECTED:
    - Allies combined attack (7) > Enemy defense (5): Enemy takes damage
    - Enemy attack (5) <= Allies combined defense (7): Allies take no damage


--------------------------------------------------------------------------------
TEST 17.8: Multi-Faction Combat (3+ sides)
--------------------------------------------------------------------------------
PURPOSE: Test three-way combat with cumulative damage

SETUP:
- Faction A, B, C all at war with each other
- Unit from each faction in same territory
- Each unit: attack=5, defense=3, organization=6

STEPS:
17.8.1 Resolve turn:
    /resolve-turn

    EXPECTED:
    - Each unit takes damage from TWO hostile sides
    - 5 > 3, so each side's attack beats others' defense
    - Each unit takes 2 org damage PER hostile (2 hostiles = 4 damage)
    - Organization: 6 - 4 = 2 for each unit


--------------------------------------------------------------------------------
TEST 17.9: Retreat Mechanics
--------------------------------------------------------------------------------
PURPOSE: Test retreat follows original movement path

SETUP:
1. Create path: T1 -> T2 -> T3
2. Unit A transits from T1 to T3
3. Unit B already at T3, hostile to A

STEPS:
17.9.1 Resolve movement phase (unit A arrives at T3)
17.9.2 Combat occurs
17.9.3 If unit A retreats:

    EXPECTED:
    - COMBAT_RETREAT event
    - Unit A retreats to T2 (previous territory in path)
    - If T2 is unsafe, finds next best option


--------------------------------------------------------------------------------
TEST 17.10: Max Combat Rounds Safety Limit
--------------------------------------------------------------------------------
PURPOSE: Test combat terminates after 10 rounds

SETUP:
- Two units that cannot deal damage to each other (attack <= defense)
- No possible retreat destination (surrounded by hostiles or water)

STEPS:
17.10.1 Resolve turn:
    /resolve-turn

    EXPECTED:
    - Combat continues for 10 rounds
    - COMBAT_MAX_ROUNDS warning event
    - Combat terminates even if not resolved


================================================================================
CLEANUP
================================================================================

After testing, clean up all test data:

/clear-wargame-config
